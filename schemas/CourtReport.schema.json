{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Betreuungsaufgabe",
  "type": "object",
  "properties": {
    "taskId": {
      "type": "string",
      "description": "Eindeutige Kennung der Aufgabe"
    },
    "date": {
      "type": "string",
      "format": "date",
      "description": "Datum der Aufgabe im Format YYYY-MM-DD"
    },
    "clientId": {
      "type": "string",
      "description": "Kennung der betreuten Person"
    },
    "taskType": {
      "type": "string",
      "enum": [
        "Beratung",
        "Dokumentation",
        "Terminkoordination",
        "CourtReport"
      ],
      "description": "Art der Aufgabe"
    },
    "description": {
      "type": "string",
      "description": "Detaillierte Beschreibung der Aufgabe"
    },
    "status": {
      "type": "string",
      "enum": ["offen", "inBearbeitung", "abgeschlossen"],
      "description": "Bearbeitungsstatus der Aufgabe"
    },
    "legalReference": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Rechtsgrundlagen bzw. Paragraphen"
    },
    "timeSpent": {
      "type": "object",
      "properties": {
        "hours": {
          "type": "number"
        },
        "minutes": {
          "type": "number"
        }
      },
      "required": [],
      "description": "Erfasste Zeit zur Aufgabenerledigung"
    },
    "notes": {
      "type": "string",
      "description": "Freitext-Feld für Anmerkungen"
    },
    "attachments": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "fileName": {
            "type": "string"
          },
          "fileUrl": {
            "type": "string",
            "format": "uri"
          }
        },
        "required": ["fileName", "fileUrl"]
      },
      "description": "Liste von Dateianhängen"
    },
    "courtReportDetails": {
      "type": "object",
      "description": "Spezifische Inhalte des Berichts an das Betreuungsgericht",
      "properties": {
        "summary": {
          "type": "string",
          "description": "Zusammenfassung der Betreuungsmaßnahmen"
        },
        "budgetOverview": {
          "type": "string",
          "description": "Budgetübersicht"
        },
        "riskAssessment": {
          "type": "string",
          "description": "Risikoeinschätzung"
        },
        "recommendations": {
          "type": "string",
          "description": "Empfehlungen für das Gericht"
        }
      },
      "required": ["summary", "budgetOverview", "riskAssessment", "recommendations"]
    }
  },
  "required": ["taskId", "date", "clientId", "taskType", "description", "status"],
  "if": {
    "properties": { "taskType": { "const": "CourtReport" } }
  },
  "then": {
    "required": ["courtReportDetails"]
  },
  "additionalProperties": false
}
